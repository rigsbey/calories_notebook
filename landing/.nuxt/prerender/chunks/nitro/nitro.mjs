import e from"node:process";globalThis._importMeta_=globalThis._importMeta_||{url:"file:///_entry.js",env:e.env};import{defineEventHandler as t,handleCacheHeaders as r,splitCookiesString as o,createEvent as n,fetchWithEvent as s,isEvent as a,eventHandler as i,setHeaders as c,sendRedirect as l,proxyRequest as u,getRequestHeader as d,setResponseHeaders as h,setResponseStatus as f,send as m,getRequestHeaders as p,setResponseHeader as g,appendResponseHeader as y,getRequestURL as x,getResponseHeader as w,removeResponseHeader as b,createError as _,createApp as v,createRouter as k,toNodeListener as A,lazyEventHandler as j,getResponseStatus as P}from"file:///Users/kamil/PycharmProjects/calories_notebook/landing/node_modules/h3/dist/index.mjs";import R from"file:///Users/kamil/PycharmProjects/calories_notebook/landing/node_modules/destr/dist/index.mjs";import{createHooks as U}from"file:///Users/kamil/PycharmProjects/calories_notebook/landing/node_modules/hookable/dist/index.mjs";import{createFetch as C,Headers as E}from"file:///Users/kamil/PycharmProjects/calories_notebook/landing/node_modules/ofetch/dist/node.mjs";import{fetchNodeRequestHandler as H,callNodeRequestHandler as S}from"file:///Users/kamil/PycharmProjects/calories_notebook/landing/node_modules/node-mock-http/dist/index.mjs";import{parseURL as N,withoutBase as T,joinURL as O,getQuery as F,withQuery as I,decodePath as L,withLeadingSlash as $,withoutTrailingSlash as M}from"file:///Users/kamil/PycharmProjects/calories_notebook/landing/node_modules/ufo/dist/index.mjs";import{createStorage as q,defineDriver as z,prefixStorage as B}from"file:///Users/kamil/PycharmProjects/calories_notebook/landing/node_modules/unstorage/dist/index.mjs";import W from"file:///Users/kamil/PycharmProjects/calories_notebook/landing/node_modules/unstorage/drivers/fs.mjs";import D from"file:///Users/kamil/PycharmProjects/calories_notebook/landing/node_modules/unstorage/drivers/fs-lite.mjs";import K from"file:///Users/kamil/PycharmProjects/calories_notebook/landing/node_modules/unstorage/drivers/lru-cache.mjs";import{digest as J}from"file:///Users/kamil/PycharmProjects/calories_notebook/landing/node_modules/ohash/dist/index.mjs";import{klona as V}from"file:///Users/kamil/PycharmProjects/calories_notebook/landing/node_modules/klona/dist/index.mjs";import X,{defuFn as G}from"file:///Users/kamil/PycharmProjects/calories_notebook/landing/node_modules/defu/dist/defu.mjs";import{snakeCase as Q}from"file:///Users/kamil/PycharmProjects/calories_notebook/landing/node_modules/scule/dist/index.mjs";import{getContext as Y}from"file:///Users/kamil/PycharmProjects/calories_notebook/landing/node_modules/unctx/dist/index.mjs";import{toRouteMatcher as Z,createRouter as ee}from"file:///Users/kamil/PycharmProjects/calories_notebook/landing/node_modules/radix3/dist/index.mjs";import{promises as te}from"node:fs";import{fileURLToPath as re}from"node:url";import{dirname as oe,resolve as ne}from"file:///Users/kamil/PycharmProjects/calories_notebook/landing/node_modules/pathe/dist/index.mjs";const se=[{baseName:"server",dir:"/Users/kamil/PycharmProjects/calories_notebook/landing/server/assets"}],ae=q();for(const e of se)ae.mount(e.baseName,W({base:e.dir,ignore:e?.ignore||[]}));const normalizeFsKey=e=>decodeURIComponent(e.replaceAll(":","_")),ie=z(e=>{const t=D({base:e.base}),r=K({max:1e3});return{...t,async setItem(e,o,n){await Promise.all([t.setItem?.(normalizeFsKey(e),o,n),r.setItem?.(e,o,n)])},hasItem:async(e,o)=>await r.hasItem(e,o)||await t.hasItem(normalizeFsKey(e),o),getItem:async(e,o)=>await r.getItem(e,o)||await t.getItem(normalizeFsKey(e),o)}}),ce=q({});function useStorage(e=""){return e?B(ce,e):ce}ce.mount("/assets",ae),ce.mount("internal:nuxt:prerender",ie({driver:"/Users/kamil/PycharmProjects/calories_notebook/landing/node_modules/nuxt/dist/core/runtime/nitro/utils/cache-driver.js",base:"/Users/kamil/PycharmProjects/calories_notebook/landing/.nuxt/cache/nitro/prerender"})),ce.mount("data",D({driver:"fsLite",base:"./.data/kv"})),ce.mount("root",W({driver:"fs",readOnly:!0,base:"/Users/kamil/PycharmProjects/calories_notebook/landing",watchOptions:{ignored:[null]}})),ce.mount("src",W({driver:"fs",readOnly:!0,base:"/Users/kamil/PycharmProjects/calories_notebook/landing/server",watchOptions:{ignored:[null]}})),ce.mount("build",W({driver:"fs",readOnly:!1,base:"/Users/kamil/PycharmProjects/calories_notebook/landing/.nuxt"})),ce.mount("cache",W({driver:"fs",readOnly:!1,base:"/Users/kamil/PycharmProjects/calories_notebook/landing/.nuxt/cache"}));const le=(()=>{class Hasher2{buff="";#e=new Map;write(e){this.buff+=e}dispatch(e){return this[null===e?"null":typeof e](e)}object(e){if(e&&"function"==typeof e.toJSON)return this.object(e.toJSON());const t=Object.prototype.toString.call(e);let r="";const o=t.length;r=o<10?"unknown:["+t+"]":t.slice(8,o-1),r=r.toLowerCase();let n=null;if(void 0!==(n=this.#e.get(e)))return this.dispatch("[CIRCULAR:"+n+"]");if(this.#e.set(e,this.#e.size),"undefined"!=typeof Buffer&&Buffer.isBuffer&&Buffer.isBuffer(e))return this.write("buffer:"),this.write(e.toString("utf8"));if("object"!==r&&"function"!==r&&"asyncfunction"!==r)this[r]?this[r](e):this.unknown(e,r);else{const t=Object.keys(e).sort(),r=[];this.write("object:"+(t.length+r.length)+":");const dispatchForKey=t=>{this.dispatch(t),this.write(":"),this.dispatch(e[t]),this.write(",")};for(const e of t)dispatchForKey(e);for(const e of r)dispatchForKey(e)}}array(e,t){if(t=void 0!==t&&t,this.write("array:"+e.length+":"),!t||e.length<=1){for(const t of e)this.dispatch(t);return}const r=new Map,o=e.map(e=>{const t=new Hasher2;t.dispatch(e);for(const[e,o]of t.#e)r.set(e,o);return t.toString()});return this.#e=r,o.sort(),this.array(o,!1)}date(e){return this.write("date:"+e.toJSON())}symbol(e){return this.write("symbol:"+e.toString())}unknown(e,t){if(this.write(t),e)return this.write(":"),e&&"function"==typeof e.entries?this.array([...e.entries()],!0):void 0}error(e){return this.write("error:"+e.toString())}boolean(e){return this.write("bool:"+e)}string(e){this.write("string:"+e.length+":"),this.write(e)}function(e){this.write("fn:"),!function(e){if("function"!=typeof e)return!1;return"[native code] }"===Function.prototype.toString.call(e).slice(-15)}(e)?this.dispatch(e.toString()):this.dispatch("[native]")}number(e){return this.write("number:"+e)}null(){return this.write("Null")}undefined(){return this.write("Undefined")}regexp(e){return this.write("regex:"+e.toString())}arraybuffer(e){return this.write("arraybuffer:"),this.dispatch(new Uint8Array(e))}url(e){return this.write("url:"+e.toString())}map(e){this.write("map:");const t=[...e];return this.array(t,!1)}set(e){this.write("set:");const t=[...e];return this.array(t,!1)}bigint(e){return this.write("bigint:"+e.toString())}}for(const e of["uint8array","uint8clampedarray","unt8array","uint16array","unt16array","uint32array","unt32array","float32array","float64array"])Hasher2.prototype[e]=function(t){return this.write(e+":"),this.array([...t],!1)};return Hasher2})();function hash(e){return J("string"==typeof e?e:function(e){const t=new le;return t.dispatch(e),t.buff}(e)).replace(/[-_]/g,"").slice(0,10)}function defineCachedFunction(e,t={}){t={name:"_",base:"/cache",swr:!0,maxAge:1,...t};const r={},o=t.group||"nitro/functions",n=t.name||e.name||"_",s=t.integrity||hash([e,t]),i=t.validate||(e=>void 0!==e.value);return async(...c)=>{if(await(t.shouldBypassCache?.(...c)))return e(...c);const l=await(t.getKey||getKey)(...c),u=await(t.shouldInvalidateCache?.(...c)),d=await async function(e,a,c,l){const u=[t.base,o,n,e+".json"].filter(Boolean).join(":").replace(/:\/$/,":index");let d=await useStorage().getItem(u).catch(e=>{console.error("[cache] Cache read error.",e),useNitroApp().captureError(e,{event:l,tags:["cache"]})})||{};if("object"!=typeof d){d={};const e=new Error("Malformed data read from cache.");console.error("[cache]",e),useNitroApp().captureError(e,{event:l,tags:["cache"]})}const h=1e3*(t.maxAge??0);h&&(d.expires=Date.now()+h);const f=c||d.integrity!==s||h&&Date.now()-(d.mtime||0)>h||!1===i(d),m=f?(async()=>{const o=r[e];o||(void 0!==d.value&&(t.staleMaxAge||0)>=0&&!1===t.swr&&(d.value=void 0,d.integrity=void 0,d.mtime=void 0,d.expires=void 0),r[e]=Promise.resolve(a()));try{d.value=await r[e]}catch(t){throw o||delete r[e],t}if(!o&&(d.mtime=Date.now(),d.integrity=s,delete r[e],!1!==i(d))){let e;t.maxAge&&!t.swr&&(e={ttl:t.maxAge});const r=useStorage().setItem(u,d,e).catch(e=>{console.error("[cache] Cache write error.",e),useNitroApp().captureError(e,{event:l,tags:["cache"]})});l?.waitUntil&&l.waitUntil(r)}})():Promise.resolve();return void 0===d.value?await m:f&&l&&l.waitUntil&&l.waitUntil(m),t.swr&&!1!==i(d)?(m.catch(e=>{console.error("[cache] SWR handler error.",e),useNitroApp().captureError(e,{event:l,tags:["cache"]})}),d):m.then(()=>d)}(l,()=>e(...c),u,c[0]&&a(c[0])?c[0]:void 0);let h=d.value;return t.transform&&(h=await t.transform(d,...c)||h),h}}function getKey(...e){return e.length>0?hash(e):""}function escapeKey(e){return String(e).replace(/\W/g,"")}function cloneWithProxy(e,t){return new Proxy(e,{get:(e,r,o)=>r in t?t[r]:Reflect.get(e,r,o),set:(e,r,o,n)=>r in t?(t[r]=o,!0):Reflect.set(e,r,o,n)})}const cachedEventHandler=function(e,a={name:"_",base:"/cache",swr:!0,maxAge:1}){const i=(a.varies||[]).filter(Boolean).map(e=>e.toLowerCase()).sort(),c={...a,getKey:async e=>{const t=await(a.getKey?.(e));if(t)return escapeKey(t);const r=e.node.req.originalUrl||e.node.req.url||e.path;let o;try{o=escapeKey(decodeURI(N(r).pathname)).slice(0,16)||"index"}catch{o="-"}return[`${o}.${hash(r)}`,...i.map(t=>[t,e.node.req.headers[t]]).map(([e,t])=>`${escapeKey(e)}.${hash(t)}`)].join(":")},validate:e=>!!e.value&&(!(e.value.code>=400)&&(void 0!==e.value.body&&("undefined"!==e.value.headers.etag&&"undefined"!==e.value.headers["last-modified"]))),group:a.group||"nitro/handlers",integrity:a.integrity||hash([e,a])},l=function(e,t={}){return defineCachedFunction(e,t)}(async t=>{const r={};for(const e of i){const o=t.node.req.headers[e];void 0!==o&&(r[e]=o)}const o=cloneWithProxy(t.node.req,{headers:r}),l={};let u;const d=cloneWithProxy(t.node.res,{statusCode:200,writableEnded:!1,writableFinished:!1,headersSent:!1,closed:!1,getHeader:e=>l[e],setHeader(e,t){return l[e]=t,this},getHeaderNames:()=>Object.keys(l),hasHeader:e=>e in l,removeHeader(e){delete l[e]},getHeaders:()=>l,end(e,t,r){return"string"==typeof e&&(u=e),"function"==typeof t&&t(),"function"==typeof r&&r(),this},write:(e,t,r)=>("string"==typeof e&&(u=e),"function"==typeof t&&t(void 0),"function"==typeof r&&r(),!0),writeHead(e,t){if(this.statusCode=e,t){if(Array.isArray(t)||"string"==typeof t)throw new TypeError("Raw headers  is not supported.");for(const e in t){const r=t[e];void 0!==r&&this.setHeader(e,r)}}return this}}),h=n(o,d);h.fetch=(e,t)=>s(h,e,t,{fetch:useNitroApp().localFetch}),h.$fetch=(e,t)=>s(h,e,t,{fetch:globalThis.$fetch}),h.waitUntil=t.waitUntil,h.context=t.context,h.context.cache={options:c};const f=await e(h)||u,m=h.node.res.getHeaders();m.etag=String(m.Etag||m.etag||`W/"${hash(f)}"`),m["last-modified"]=String(m["Last-Modified"]||m["last-modified"]||(new Date).toUTCString());const p=[];a.swr?(a.maxAge&&p.push(`s-maxage=${a.maxAge}`),a.staleMaxAge?p.push(`stale-while-revalidate=${a.staleMaxAge}`):p.push("stale-while-revalidate")):a.maxAge&&p.push(`max-age=${a.maxAge}`),p.length>0&&(m["cache-control"]=p.join(", "));return{code:h.node.res.statusCode,headers:m,body:f}},c);return t(async t=>{if(a.headersOnly){if(r(t,{maxAge:a.maxAge}))return;return e(t)}const n=await l(t);if(t.node.res.headersSent||t.node.res.writableEnded)return n.body;if(!r(t,{modifiedTime:new Date(n.headers["last-modified"]),etag:n.headers.etag,maxAge:a.maxAge})){t.node.res.statusCode=n.code;for(const e in n.headers){const r=n.headers[e];"set-cookie"===e?t.node.res.appendHeader(e,o(r)):void 0!==r&&t.node.res.setHeader(e,r)}return n.body}})},ue=G({nuxt:{}});function getEnv(t,r){const o=Q(t).toUpperCase();return R(e.env[r.prefix+o]??e.env[r.altPrefix+o])}function _isObject(e){return"object"==typeof e&&!Array.isArray(e)}function applyEnv(e,t,r=""){for(const o in e){const n=r?`${r}_${o}`:o,s=getEnv(n,t);_isObject(e[o])?_isObject(s)?(e[o]={...e[o],...s},applyEnv(e[o],t,n)):void 0===s?applyEnv(e[o],t,n):e[o]=s??e[o]:e[o]=s??e[o],t.envExpansion&&"string"==typeof e[o]&&(e[o]=_expandFromEnv(e[o]))}return e}const de=/\{\{([^{}]*)\}\}/g;function _expandFromEnv(t){return t.replace(de,(t,r)=>e.env[r]||t)}const he={app:{baseURL:"/",buildId:"76358421-26d3-401e-a69d-857c3f9469c5",buildAssetsDir:"/_nuxt/",cdnURL:""},nitro:{envPrefix:"NUXT_",routeRules:{"/__nuxt_error":{cache:!1},"/_nuxt/builds/meta/**":{headers:{"cache-control":"public, max-age=31536000, immutable"}},"/_nuxt/builds/**":{headers:{"cache-control":"public, max-age=1, immutable"}},"/_nuxt/**":{headers:{"cache-control":"public, max-age=31536000, immutable"}}}},public:{siteUrl:"https://calories.toxiguard.site",telegramBot:"@caloriesnote_bot"}},fe={prefix:"NITRO_",altPrefix:he.nitro.envPrefix??e.env.NITRO_ENV_PREFIX??"_",envExpansion:he.nitro.envExpansion??e.env.NITRO_ENV_EXPANSION??!1},me=_deepFreeze(applyEnv(V(he),fe));function useRuntimeConfig(e){if(!e)return me;if(e.context.nitro.runtimeConfig)return e.context.nitro.runtimeConfig;const t=V(he);return applyEnv(t,fe),e.context.nitro.runtimeConfig=t,t}function _deepFreeze(e){const t=Object.getOwnPropertyNames(e);for(const r of t){const t=e[r];t&&"object"==typeof t&&_deepFreeze(t)}return Object.freeze(e)}_deepFreeze(V(ue)),new Proxy(Object.create(null),{get:(e,t)=>{console.warn("Please use `useRuntimeConfig()` instead of accessing config directly.");const r=useRuntimeConfig();if(t in r)return r[t]}}),Y("nitro-app",{asyncContext:!1,AsyncLocalStorage:void 0});const pe=Z(ee({routes:useRuntimeConfig().nitro.routeRules}));function getRouteRules(e){return e.context._nitro=e.context._nitro||{},e.context._nitro.routeRules||(e.context._nitro.routeRules=getRouteRulesForPath(T(e.path.split("?")[0],useRuntimeConfig().app.baseURL))),e.context._nitro.routeRules}function getRouteRulesForPath(e){return X({},...pe.matchAll(e).reverse())}function _captureError(e,t){console.error(`[${t}]`,e),useNitroApp().captureError(e,{tags:[t]})}function joinHeaders(e){return Array.isArray(e)?e.join(", "):String(e)}function normalizeCookieHeader(e=""){return o(joinHeaders(e))}function normalizeCookieHeaders(e){const t=new Headers;for(const[r,o]of e)if("set-cookie"===r)for(const e of normalizeCookieHeader(o))t.append("set-cookie",e);else t.set(r,joinHeaders(o));return t}function hasReqHeader(e,t,r){const o=d(e,t);return o&&"string"==typeof o&&o.toLowerCase().includes(r)}function defaultHandler(e,t,r){const o=e.unhandled||e.fatal,n=e.statusCode||500,s=e.statusMessage||"Server Error",a=x(t,{xForwardedHost:!0,xForwardedProto:!0});if(404===n){const e="/";if(/^\/[^/]/.test(e)&&!a.pathname.startsWith(e)){return{status:302,statusText:"Found",headers:{location:`${e}${a.pathname.slice(1)}${a.search}`},body:"Redirecting..."}}}if(o&&!r?.silent){const r=[e.unhandled&&"[unhandled]",e.fatal&&"[fatal]"].filter(Boolean).join(" ");console.error(`[request error] ${r} [${t.method}] ${a}\n`,e)}const i={"content-type":"application/json","x-content-type-options":"nosniff","x-frame-options":"DENY","referrer-policy":"no-referrer","content-security-policy":"script-src 'none'; frame-ancestors 'none';"};f(t,n,s),404!==n&&w(t,"cache-control")||(i["cache-control"]="no-cache");return{status:n,statusText:s,headers:i,body:{error:!0,url:a.href,statusCode:n,statusMessage:s,message:o?"Server Error":e.message,data:o?void 0:e.data}}}const ge=[async function(e,t,{defaultHandler:r}){if(t.handled||function(e){return!hasReqHeader(e,"accept","text/html")&&(hasReqHeader(e,"accept","application/json")||hasReqHeader(e,"user-agent","curl/")||hasReqHeader(e,"user-agent","httpie/")||hasReqHeader(e,"sec-fetch-mode","cors")||e.path.startsWith("/api/")||e.path.endsWith(".json"))}(t))return;const o=await r(e,t,{json:!0});if(404===(e.statusCode||500)&&302===o.status)return h(t,o.headers),f(t,o.status,o.statusText),m(t,JSON.stringify(o.body,null,2));const n=o.body,s=new URL(n.url);n.url=T(s.pathname,useRuntimeConfig(t).app.baseURL)+s.search+s.hash,n.message||="Server Error",n.data||=e.data,n.statusMessage||=e.statusMessage,delete o.headers["content-type"],delete o.headers["content-security-policy"],h(t,o.headers);const a=p(t),i=t.path.startsWith("/__nuxt_error")||!!a["x-nuxt-error"]?null:await useNitroApp().localFetch(I(O(useRuntimeConfig(t).app.baseURL,"/__nuxt_error"),n),{headers:{...a,"x-nuxt-error":"true"},redirect:"manual"}).catch(()=>null);if(t.handled)return;if(!i){const{template:e}=await import("../_/error-500.mjs");return g(t,"Content-Type","text/html;charset=UTF-8"),m(t,e(n))}const c=await i.text();for(const[e,r]of i.headers.entries())"set-cookie"!==e?g(t,e,r):y(t,e,r);return f(t,i.status&&200!==i.status?i.status:o.status,i.statusText||o.statusText),m(t,c)},function(e,t){const r=defaultHandler(e,t);return h(t,r.headers),f(t,r.status,r.statusText),m(t,JSON.stringify(r.body,null,2))}];const ye=[],xe={};const we={"/_nuxt/builds/meta/":{maxAge:31536e3},"/_nuxt/builds/":{maxAge:1},"/_nuxt/":{maxAge:31536e3}};function getAsset(e){return xe[e]}const be=new Set(["HEAD","GET"]),_e={gzip:".gz",br:".br"},ve=[{route:"",handler:i(e=>{if(e.method&&!be.has(e.method))return;let t,r=L($(M(N(e.path).pathname)));const o=[...String(d(e,"accept-encoding")||"").split(",").map(e=>_e[e.trim()]).filter(Boolean).sort(),""];o.length>1&&y(e,"Vary","Accept-Encoding");for(const e of o)for(const o of[r+e,O(r,"index.html"+e)]){const e=getAsset(o);if(e){t=e,r=o;break}}if(!t){if(function(e=""){if(xe[e])return!0;for(const t in we)if(e.startsWith(t))return!0;return!1}(r))throw b(e,"Cache-Control"),_({statusCode:404});return}if(d(e,"if-none-match")===t.etag)return f(e,304,"Not Modified"),"";const n=d(e,"if-modified-since"),s=new Date(t.mtime);return n&&t.mtime&&new Date(n)>=s?(f(e,304,"Not Modified"),""):(t.type&&!w(e,"Content-Type")&&g(e,"Content-Type",t.type),t.etag&&!w(e,"ETag")&&g(e,"ETag",t.etag),t.mtime&&!w(e,"Last-Modified")&&g(e,"Last-Modified",s.toUTCString()),t.encoding&&!w(e,"Content-Encoding")&&g(e,"Content-Encoding",t.encoding),t.size>0&&!w(e,"Content-Length")&&g(e,"Content-Length",t.size),function(e){const t=oe(re(globalThis._importMeta_.url));return te.readFile(ne(t,xe[e].path))}(r))}),lazy:!1,middleware:!0,method:void 0},{route:"/__nuxt_island/**",handler:t(()=>{}),lazy:!1,middleware:!1,method:void 0},{route:"/**",handler:()=>import("../_/renderer.mjs").then(function(e){return e.r}),lazy:!0,middleware:!1,method:void 0}];const ke=function(){const e=useRuntimeConfig(),t=U(),captureError=(e,r={})=>{const o=t.callHookParallel("error",e,r).catch(e=>{console.error("Error while capturing another error",e)});if(r.event&&a(r.event)){const t=r.event.context.nitro?.errors;t&&t.push({error:e,context:r}),r.event.waitUntil&&r.event.waitUntil(o)}},r=v({debug:R(!1),onError:(e,t)=>(captureError(e,{event:t,tags:["request"]}),async function(e,t){for(const r of ge)try{if(await r(e,t,{defaultHandler:defaultHandler}),t.handled)return}catch(e){console.error(e)}}(e,t)),onRequest:async e=>{e.context.nitro=e.context.nitro||{errors:[]};const t=e.node.req?.__unenv__;t?._platform&&(e.context={_platform:t?._platform,...t._platform,...e.context}),!e.context.waitUntil&&t?.waitUntil&&(e.context.waitUntil=t.waitUntil),e.fetch=(t,r)=>s(e,t,r,{fetch:localFetch}),e.$fetch=(t,r)=>s(e,t,r,{fetch:d}),e.waitUntil=t=>{e.context.nitro._waitUntilPromises||(e.context.nitro._waitUntilPromises=[]),e.context.nitro._waitUntilPromises.push(t),e.context.waitUntil&&e.context.waitUntil(t)},e.captureError=(t,r)=>{captureError(t,{event:e,...r})},await ke.hooks.callHook("request",e).catch(t=>{captureError(t,{event:e,tags:["request"]})})},onBeforeResponse:async(e,t)=>{await ke.hooks.callHook("beforeResponse",e,t).catch(t=>{captureError(t,{event:e,tags:["request","response"]})})},onAfterResponse:async(e,t)=>{await ke.hooks.callHook("afterResponse",e,t).catch(t=>{captureError(t,{event:e,tags:["request","response"]})})}}),o=k({preemptive:!0}),n=A(r),localFetch=(e,t)=>e.toString().startsWith("/")?H(n,e,t).then(e=>function(e){return e.headers.has("set-cookie")?new Response(e.body,{status:e.status,statusText:e.statusText,headers:normalizeCookieHeaders(e.headers)}):e}(e)):globalThis.fetch(e,t),d=C({fetch:localFetch,Headers:E,defaults:{baseURL:e.app.baseURL}});var h;globalThis.$fetch=d,r.use((h={localFetch:localFetch},i(e=>{const t=getRouteRules(e);if(t.headers&&c(e,t.headers),t.redirect){let r=t.redirect.to;if(r.endsWith("/**")){let o=e.path;const n=t.redirect._redirectStripBase;n&&(o=T(o,n)),r=O(r.slice(0,-3),o)}else if(e.path.includes("?")){const t=F(e.path);r=I(r,t)}return l(e,r,t.redirect.statusCode)}if(t.proxy){let r=t.proxy.to;if(r.endsWith("/**")){let o=e.path;const n=t.proxy._proxyStripBase;n&&(o=T(o,n)),r=O(r.slice(0,-3),o)}else if(e.path.includes("?")){const t=F(e.path);r=I(r,t)}return u(e,r,{fetch:h.localFetch,...t.proxy})}})));for(const t of ve){let n=t.lazy?j(t.handler):t.handler;if(t.middleware||!t.route){const o=(e.app.baseURL+(t.route||"/")).replace(/\/+/g,"/");r.use(o,n)}else{const e=getRouteRulesForPath(t.route.replace(/:\w+|\*\*/g,"_"));e.cache&&(n=cachedEventHandler(n,{group:"nitro/routes",...e.cache})),o.use(t.route,n,t.method)}}return r.use(e.app.baseURL,o.handler),{hooks:t,h3App:r,router:o,localCall:e=>S(n,e),localFetch:localFetch,captureError:captureError}}();function useNitroApp(){return ke}function defineRenderHandler(e){const t=useRuntimeConfig();return i(async r=>{const o=useNitroApp(),n={event:r,render:e,response:void 0};if(await o.hooks.callHook("render:before",n),!n.response){if(r.path===`${t.app.baseURL}favicon.ico`)return g(r,"Content-Type","image/x-icon"),m(r,"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7");if(n.response=await n.render(r),!n.response){const e=P(r);return f(r,200===e?500:e),m(r,"No response returned from render handler: "+r.path)}}return await o.hooks.callHook("render:response",n.response,n),n.response.headers&&h(r,n.response.headers),(n.response.statusCode||n.response.statusMessage)&&f(r,n.response.statusCode,n.response.statusMessage),n.response.body})}!function(e){for(const t of ye)try{t(e)}catch(t){throw e.captureError(t,{tags:["plugin"]}),t}}(ke);const Ae=useNitroApp(),je=Ae.localFetch,closePrerenderer=()=>Ae.hooks.callHook("close");e.on("unhandledRejection",e=>_captureError(e,"unhandledRejection")),e.on("uncaughtException",e=>_captureError(e,"uncaughtException"));export{useStorage as a,useNitroApp as b,closePrerenderer as c,defineRenderHandler as d,getRouteRules as g,je as l,useRuntimeConfig as u};
//# sourceMappingURL=nitro.mjs.map
